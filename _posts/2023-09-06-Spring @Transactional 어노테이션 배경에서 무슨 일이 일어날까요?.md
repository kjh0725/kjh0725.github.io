---
title: Spring Transactional 어노테이션 배경에서 무슨 일이 일어날까요?
date: 2023-09-06 20:00:00 +0900
categories:
  - Spring
tags:
  - Spring
  - transcational
---
## 소개

Spring Framework에서는 데이터베이스 트랜잭션을 관리하기 위해 `@Transactional`이라는 어노테이션을 제공합니다. 이 글에서는 이 어노테이션을 사용할 때 시스템 내부에서 어떤 프로세스가 진행되는지 자세히 알아보겠습니다.

## @Transactional의 작동 원리

Spring의 `@Transactional` 어노테이션은 메서드 또는 클래스에 적용되며, 해당 영역에서의 데이터베이스 작업을 하나의 트랜잭션으로 묶습니다. 즉, 작업들이 모두 성공하거나 모두 실패하도록 관리합니다.

1. **프록시 객체 생성**: `@Transactional`이 적용된 메서드가 호출되면, Spring은 해당 클래스의 '프록시 객체'를 생성합니다. 프록시란 실제 객체를 대신해 작동하는 객체입니다.
  
2. **트랜잭션 매니저 활성화**: 프록시 객체는 트랜잭션 매니저를 활성화시켜 데이터베이스 연결을 시작합니다.

3. **트랜잭션 경계 설정**: 트랜잭션 시작과 끝을 명확하게 정의합니다. 만약 중간에 문제가 발생한다면, 롤백(Rollback)을 수행하여 변경 사항을 취소합니다.

4. **트랜잭션 커밋 또는 롤백**: 메서드 실행이 성공적으로 완료되면 트랜잭션을 커밋(Commit)합니다. 실패하면 롤백(Rollback)합니다.

5. **프록시 객체 제거**: 트랜잭션이 종료되면 생성된 프록시 객체는 제거됩니다.

## 주의사항과 일반적인 문제점

1. **Propagation Level**: `@Transactional` 어노테이션에는 propagation level이라는 설정이 있습니다. 이는 트랜잭션이 어떻게 전파될지를 설정하는 것입니다. 잘못 설정하면 문제가 발생할 수 있습니다.

2. **Isolation Level**: 격리 수준(Isolation Level)을 잘못 설정하면 데이터 무결성(Data Integrity) 문제가 발생할 수 있습니다.

3. **`LazyInitializationException` 오류**: 어노테이션을 잘못 사용하면 이러한 오류가 발생할 수 있습니다. 이는 데이터를 느리게 초기화하려고 할 때 일어납니다.

## 결론

`@Transactional` 어노테이션은 Spring에서 데이터베이스 트랜잭션을 효과적으로 관리할 수 있게 해줍니다. 하지만 이를 사용하려면 내부 메커니즘을 잘 이해하고, 올바른 설정을 해야 합니다. 주의사항과 문제점을 이해하면 더욱 효과적으로 이 기능을 활용할 수 있습니다.